{% assign current_lang = page.lang | default: site.default_lang %}
{% assign t = site.data.translations[current_lang] %}
{% assign lang_prefix = "/" | append: current_lang %}
{% assign visible_posts = site.articles | where: "lang", current_lang | where_exp: "post", "post.hidden != true" %}
{% assign visible_tags = visible_posts | map: "tags" | join: "," | split: "," | uniq | sort %}

<div class="mt-10">
  <p class="text-xs uppercase text-slate-400 dark:text-slate-500">{{ t.tags.browse_by | default: t.categories.browse_by }}</p>
  <h1 class="mt-3 text-4xl font-semibold leading-tight md:text-[2.75rem]">{{ t.tags.title }}</h1>
  <p class="mt-4 text-base text-slate-500 dark:text-slate-400">{{ visible_tags.size }} {{ t.tags.plural }} {{ t.common.across_all }}</p>
</div>

<section class="mt-10">
  <div class="flex flex-wrap gap-3">
    {% for tag_name in visible_tags %}
    {% if tag_name != "" %}
    {% assign tag_count = 0 %}
    {% for post in visible_posts %}
      {% if post.tags contains tag_name %}
        {% assign tag_count = tag_count | plus: 1 %}
      {% endif %}
    {% endfor %}
    <a href="{{ lang_prefix | append: '/tags/' | append: tag_name | append: '/' | relative_url }}"
       class="inline-flex items-center gap-2 rounded-full border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 px-4 py-2 text-sm font-medium text-slate-600 dark:text-slate-400 transition hover:border-[#fc4d50] hover:text-[#fc4d50]">
      #{{ tag_name }}
      <span class="rounded-full bg-slate-100 dark:bg-slate-700 px-2 py-0.5 text-xs text-slate-500 dark:text-slate-400">{{ tag_count }}</span>
    </a>
    {% endif %}
    {% endfor %}
  </div>
</section>

<section class="mt-12 flex flex-col gap-4 border-t border-slate-200 dark:border-slate-800 pt-6 text-sm text-slate-500 dark:text-slate-400 md:flex-row md:items-center md:justify-between">
  <a class="inline-flex items-center gap-2 font-semibold text-[#fc4d50]" href="{{ lang_prefix | append: '/' | relative_url }}">
    <span aria-hidden="true">&larr;</span> {{ t.post.back_to_all }}
  </a>
</section>
